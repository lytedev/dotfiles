#!/usr/bin/env fish

# TODO: init from curl

set dfp (realpath (dirname (status -f))/../..)
set lock_file $HOME/.using-lytedev-dotfiles.lock
set -q XDG_CONFIG_HOME || set XDG_CONFIG_HOME $HOME/.config
source $dfp/common/bin/lib/meta/setup/helpers
dotfiles_setup_check_agreement $lock_file || begin
	echo Quitting due to lack of user agreement. && exit 1
end

# test ! -d "$HOME/.env" && $dfp/common/bin/lib/meta/setup/select-os-env.bash

set h $HOME; set c $XDG_CONFIG_HOME
echo yo
l common/tmux/conf $h/.tmux.conf
l common/fish $c/fish
l common/neovim $c/nvim
l common/colors/vim $c/nvim/colors/base16-donokai.vim
l common/weechat $h/.weechat
l common/scim/rc $h/.scimrc
l common/scim/lua $h/.scim/lua
l common/nnn $c/nnn
l common/kak $c/kak
l common/gpg/agent.conf $h/.gnupg/gpg-agent.conf
l common/htop/rc $c/htop/htoprc
l common/kitty $c/kitty
l common/mutt/rc $c/.muttrc
l common/git/config $h/.gitconfig
l common/elixir/iex.exs $h/.iex.exs

# desktop environment files
# "apps/de/sway/config"               "$XDG_CONFIG_HOME/sway/config"
# "apps/de/sway/lock"                 "$XDG_CONFIG_HOME/swaylock/config"
# "apps/de/mako/"                     "$XDG_CONFIG_HOME/mako"
# "apps/de/sway/mimeapps.list"        "$XDG_CONFIG_HOME/mimeapps.list"
# "apps/de/sway/mimeapps.list"        "$XDG_CONFIG_HOME/sway-mimeapps.list"
# "apps/de/sway/mimeapps.list"        "$HOME/.local/share/applications/mimeapps.list"

# gtk configuration files
# "apps/de/gtk/2rc"                   "$HOME/.gtkrc-2.0"
# "apps/de/gtk/2rc"                   "$HOME/.gtkrc"
# "apps/de/gtk/3settings.ini"         "$XDG_CONFIG_HOME/gtk-3.0/settings.ini"

# bar files
# "apps/de/waybar/"                   "$XDG_CONFIG_HOME/waybar"

# libinput configuration
# "apps/de/libinput/gestures.conf"    "$XDG_CONFIG_HOME/libinput-gestures.conf"

# document viewer
# "apps/zathura/"                     "$XDG_CONFIG_HOME/zathura"

# XDG user directories
# "apps/shell/user-dirs"              "$XDG_CONFIG_HOME/user-dirs.dirs"

# Kanshi configuration
# "apps/de/kanshi"                    "$XDG_CONFIG_HOME/kanshi"

# execute the user's shell
set ush (getent passwd $LOGNAME | cut -d: -f7)
echo Dotfiles Installed! Running $ush
exec $ush
